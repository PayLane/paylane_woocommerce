'use strict';(function(){function G(a){return 4<a?"znak\u00f3w":1<a?"znaki":"znak"}function Q(a,b){return Object.keys(a).reduce(function(c,e){c[e]=b(a[e]);return c},{})}function f(a){return"undefined"!==typeof a}function d(a){return"function"===typeof a}function u(a){return"[object RegExp]"===Object.prototype.toString.call(a)}function H(a,b,c,e=!1,d=0){let R=new S(c,d);b.split(" ").forEach((b)=>{a.addEventListener(b,function(){R.run(...arguments)},e)})}function x(a=null){return null===a?"":(a+"").replace("/",
"")}function v(a=null){return null===a?"":(a+"").split(" ").join("")}function T(a){a=v(a).split("/");70>a[1]?a[1]="20"+a[1]:100>a[1]&&(a[1]="19"+a[1]);return{month:a[0],year:a[1]}}function U(a,b={}){let c=[];V.forEach((e)=>{if(e.HTMLElementHasRule(a)||b[e.ruleName]){let d=b[e.ruleName]||{};d.element=a;e=new e(d);e.init();c.push(e)}});return c}function W(a,b={}){let c=[];if(g.HTMLElementHasRule(a)||b.required)b=b.required||{},b.element=a,a=new g(b),a.init(),c.push(a);return c}function I(a,b,c){if("input"===
a.nodeName.toLowerCase()||"select"===a.nodeName.toLowerCase())return new X(a,{validator:U(a,b.validator).concat(b.validator.rules||[]),errorMessageElement:b.errorMessageElement,name:b.name},c);if(a.hasAttribute("data-mc-field-radio"))return new Y(a,{validator:W(a,b.validator).concat(b.validator.rules||[]),errorMessageElement:b.errorMessageElement,name:b.name},c)}function J(a){let b=new Z(a.element,{name:a.name,fields:[],validator:[],errorMessageElement:a.errorMessageElement});Q(a.fields,(a)=>b.fields.push(I(a.element,
a,b)));return b}function aa(){let a=document.querySelector(h.card);return J({name:"card",element:a,fields:{number:{name:"number",element:a.querySelector('input[name="cc_card_number"]'),validator:{required:{value:!0},rules:[new y]},errorMessageElement:a.querySelector('[data-paylane-error-message="cc_card_number"]')},expirationDate:{name:"expirationDate",element:a.querySelector('input[name="cc_expiration_date"]'),validator:{required:{value:!0},rules:[new z]},errorMessageElement:a.querySelector('[data-paylane-error-message="cc_expiration_date"]')},
securityCode:{name:"securityCode",element:a.querySelector('input[name="cc_security_code"]'),validator:{required:{value:!0},rules:[new A]},errorMessageElement:a.querySelector('[data-paylane-error-message="cc_security_code"]')},nameOnCard:{name:"nameOnCard",element:a.querySelector('input[name="cc_name_on_card"]'),validator:{required:{value:!0},minLength:{value:2,errorMessage:k.nameOnCard.minLength},maxLength:{value:50,errorMessage:k.nameOnCard.maxLength}},errorMessageElement:a.querySelector('[data-paylane-error-message="cc_name_on_card"]')}},
errorMessageElement:a.querySelector('[data-paylane-error-message="credit_card"]')})}function ba(){let a=document.querySelector(h.sepaDirectDebit);return J({element:a,name:"sepaDirectDebit",fields:{accountHolder:{name:"accountHolder",element:a.querySelector('input[name="sepa_account_holder"]'),validator:{required:{value:!0},minLength:{value:2,errorMessage:k.nameOnCard.minLength},maxLength:{value:50,errorMessage:k.nameOnCard.maxLength}},errorMessageElement:a.querySelector('[data-paylane-error-message="sepa_account_holder"]')},
iban:{name:"iban",element:a.querySelector('input[name="sepa_iban"]'),validator:{required:{value:!0},pattern:{value:/^[a-zA-Z]{2}[0-9]{2}[a-zA-Z0-9]{11}([a-zA-Z0-9]?){0,16}$/}},errorMessageElement:a.querySelector('[data-paylane-error-message="sepa_iban"]')},bic:{name:"bic",element:a.querySelector('input[name="sepa_bic"]'),validator:{required:{value:!0},pattern:{value:/^[A-Z]{6}[A-Z0-9]{2}([A-Z0-9]{3})?$/}},errorMessageElement:a.querySelector('[data-paylane-error-message="sepa_bic"]')},accountCountry:{name:"accountCountry",
element:a.querySelector('[name="sepa_account_country"]'),validator:{required:{value:!0}},errorMessageElement:a.querySelector('[data-paylane-error-message="sepa_account_country"]')}}})}function ca(){let a=document.querySelector(h.polishBankTransfer),b=a.querySelector('[data-mc-field-radio="transfer_bank"]');return I(b,{name:"polishBankTransfer",element:b,validator:{required:{value:!0}},errorMessageElement:a.querySelector('[data-paylane-error-message="transfer_bank"]')})}function da(a){let b=document.querySelector('form[name="checkout"]');
b||(b=document.querySelector("form#order_review"));return new ea(b,{fields:a})}function w(){return Array.from(K()).find((a)=>a.checked).value||""}function K(){return document.querySelectorAll('input[name="payment_method"]')}function L(){let a=document.querySelector('input[name="billing_first_name"]'),b=document.querySelector('input[name="billing_last_name"]'),c="";a&&a.value&&(c=a.value);b&&b.value&&(c=`${c} ${b.value}`);return c}let k={defaults:{required:"To pole jest wymagane",pattern:"Niepoprawny format pola",
cardNumber:"Niepoprawny numer karty",cardExpirationDate:"Niepoprawny data wyga\u015bni\u0119cia karty",cardSecurityCode:"Niepoprawny kod CVV/CVC"},nameOnCard:{minLength:"Wymagane minimum 2 znaki",maxLength:"Wymagane maksimum 50 znak\u00f3w"}};var M=()=>"Niepoprawny adres email",N=(a)=>{let b=G(a);return`Wymagane maksimum ${a} ${b}`},O=(a)=>{let b=G(a);return`Wymagane minimum ${a} ${b}`},B=()=>"Niepoprawny format pola",r=()=>"To pole jest wymagane",C=()=>"Niepoprawny numer karty",D=()=>"Niepoprawny data wyga\u015bni\u0119cia karty",
E=()=>"Niepoprawny kod CVV/CVC";class S{constructor(a,b=250){this.callback=a;this.delay=b;this.timer=void 0}run(...a){this.timer&&clearTimeout(this.timer);this.timer=setTimeout(()=>{this.callback(...arguments)},this.delay)}}class y{constructor(a={}){this.isValid=this.value=!0;f(a.value)&&(this.value=!!a.value);a.errorMessage&&(this.errorMessage=a.errorMessage)}get name(){return y.ruleName}static get ruleName(){return"cardNumber"}static get DEFAULT_TEXT(){return C}static set DEFAULT_TEXT(a){C=d(a)?
a:()=>a}get errorMessage(){let a=this._text||y.DEFAULT_TEXT;return d(a)?a(this.value):a}set errorMessage(a){this._text=a}init(){return this}isEnabled(){return!!this.value}validate(a){if(this.isEnabled()&&a){var b=(a+"").replace(/\s+|-/g,"");if(a=10<=b.length&&16>=b.length){{let c,e,d,f;a=!0;e=0;c=(b+"").split("").reverse();d=0;for(f=c.length;d<f;d++)b=c[d],b=parseInt(b,10),(a=!a)&&(b*=2),9<b&&(b-=9),e+=b;a=0===e%10}}}else a=!0;this.isValid=a;return{name:this.name,errorMessage:this.errorMessage,isValid:this.isValid}}}
class z{constructor(a={}){this.isValid=this.value=!0;f(a.value)&&(this.value=!!a.value);a.errorMessage&&(this.errorMessage=a.errorMessage)}get name(){return z.ruleName}static get ruleName(){return"cardExpirationDate"}static get DEFAULT_TEXT(){return D}static set DEFAULT_TEXT(a){D=d(a)?a:()=>a}get errorMessage(){let a=this._text||z.DEFAULT_TEXT;return d(a)?a(this.value):a}set errorMessage(a){this._text=a}init(){return this}isEnabled(){return!!this.value}validate(a){if(this.isEnabled()&&a){{var b=void 0;
let c,e;b?(a=x(a),b=x(b)):(b=(a+"").split("/"),a=v(b[0]),b=v(b[1]));a=!!/^\d+$/.test(a)&&!!/^\d+$/.test(b)&&1<=a&&12>=a&&(2===b.length&&(b=70>b?"20"+b:"19"+b),4===b.length&&(e=new Date(b,a),c=new Date,e.setMonth(e.getMonth()-1),e.setMonth(e.getMonth()+1,1),e>c))}}else a=!0;this.isValid=a;return{name:this.name,errorMessage:this.errorMessage,isValid:this.isValid}}}class A{constructor(a={}){this.isValid=this.value=!0;f(a.value)&&(this.value=!!a.value);a.errorMessage&&(this.errorMessage=a.errorMessage)}get name(){return A.ruleName}static get ruleName(){return"cardSecurityCode"}static get DEFAULT_TEXT(){return E}static set DEFAULT_TEXT(a){E=
d(a)?a:()=>a}get errorMessage(){let a=this._text||A.DEFAULT_TEXT;return d(a)?a(this.value):a}set errorMessage(a){this._text=a}init(){return this}isEnabled(){return!!this.value}validate(a){if(this.isEnabled()&&a){var b=a;a=(b=x(b),/^\d+$/.test(b)&&3<=b.length&&4>=b.length)}else a=!0;this.isValid=a;return{name:this.name,errorMessage:this.errorMessage,isValid:this.isValid}}}class m{constructor(a={}){this.isValid=!0;this.value=a.value;a.errorMessage&&(this.errorMessage=a.errorMessage);a.element&&(this.element=
a.element)}get name(){return m.ruleName}static get ruleName(){return"minLength"}static get DEFAULT_TEXT(){return O}set DEFAULT_TEXT(a){O=d(a)?a:()=>a}get errorMessage(){let a=this._text||m.DEFAULT_TEXT;return d(a)?a(this.value):a}set errorMessage(a){this._text=a}init(){if(this.hasHTMLAttribute()){let a=this.getHTMLAttribute();a!==this.value&&(this.value=a)}else f(this.value)&&this.setHTMLAttribute(this.value);return this}isEnabled(){return f(this.value)&&0<this.value}validate(a){this.isValid=this.isEnabled()&&
a?a.length>=this.value:!0;return{name:this.name,errorMessage:this.errorMessage,isValid:this.isValid}}setValue(a){this.value=a;this.setHTMLAttribute(this.value);return this}hasHTMLAttribute(){return m.hasHTMLAttribute(this.element)}getHTMLAttribute(){return m.getHTMLAttribute(this.element)}setHTMLAttribute(a){m.setHTMLAttribute(this.element,a)}static hasHTMLAttribute(a){return a.hasAttribute("minlength")&&""!==a.getAttribute("minlength")}static getHTMLAttribute(a){return parseInt(a.getAttribute("minlength"))}static setHTMLAttribute(a,
b){a.setAttribute("minlength",b)}static HTMLElementHasRule(a){return m.hasHTMLAttribute(a)}}class n{constructor(a={}){this.isValid=!0;this.value=!!a.value;a.errorMessage&&(this.errorMessage=a.errorMessage);a.element&&(this.element=a.element)}get name(){return n.ruleName}static get ruleName(){return"required"}static get DEFAULT_TEXT(){return r}static set DEFAULT_TEXT(a){r=d(a)?a:()=>a}get errorMessage(){let a=this._text||n.DEFAULT_TEXT;return d(a)?a(this.value):a}set errorMessage(a){this._text=a}init(){this.hasHTMLAttribute()?
this.value=!0:this.value&&this.setHTMLAttribute(this.value);return this}isEnabled(){return!!this.value}validate(a){this.isValid=this.isEnabled()?!!a:!0;return{name:this.name,errorMessage:this.errorMessage,isValid:this.isValid}}setValue(a){this.value=!!a;this.setHTMLAttribute(this.value);return this}hasHTMLAttribute(){return n.hasHTMLAttribute(this.element)}getHTMLAttribute(){return n.getHTMLAttribute(this.element)}setHTMLAttribute(a){n.setHTMLAttribute(this.element,a)}static hasHTMLAttribute(a){return a.hasAttribute("required")}static getHTMLAttribute(a){return a.hasAttribute("required")}static setHTMLAttribute(a,
b){b?a.setAttribute("required","required"):a.removeAttribute("required")}static HTMLElementHasRule(a){return n.hasHTMLAttribute(a)}}let P=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/;class l{constructor(a={}){this.isValid=!0;this.value=!!a.value;a.errorMessage&&(this.errorMessage=a.errorMessage);a.element&&(this.element=a.element)}get name(){return l.ruleName}static get EMAIL_REGEXP(){return P}static set EMAIL_REGEXP(a){P=
a}static get ruleName(){return"email"}static get DEFAULT_TEXT(){return M}static set DEFAULT_TEXT(a){M=d(a)?a:()=>a}get errorMessage(){let a=this._text||l.DEFAULT_TEXT;return d(a)?a(this.value):a}set errorMessage(a){this._text=a}init(){this.hasHTMLAttribute()?this.value=!0:this.value&&this.setHTMLAttribute(this.value);return this}isEnabled(){return!!this.value}validate(a){this.isValid=this.isEnabled()&&a?l.EMAIL_REGEXP.test(a):!0;return{name:this.name,errorMessage:this.errorMessage,isValid:this.isValid}}setValue(a){this.value=
!!a;this.setHTMLAttribute(this.value);return this}hasHTMLAttribute(){return l.hasHTMLAttribute(this.element)}getHTMLAttribute(){return l.getHTMLAttribute(this.element)}setHTMLAttribute(a){l.setHTMLAttribute(this.element,a)}static hasHTMLAttribute(a){return"email"===a.getAttribute("type")}static getHTMLAttribute(a){return"email"===a.getAttribute("type")}static setHTMLAttribute(a,b){b?a.setAttribute("type","email"):a.setAttribute("type","text")}static HTMLElementHasRule(a){return l.hasHTMLAttribute(a)}}
class p{constructor(a={}){this.isValid=!0;this.value=a.value;a.errorMessage&&(this.errorMessage=a.errorMessage);a.element&&(this.element=a.element)}get name(){return p.ruleName}static get ruleName(){return"maxLength"}static get DEFAULT_TEXT(){return N}set DEFAULT_TEXT(a){N=d(a)?a:()=>a}get errorMessage(){let a=this._text||p.DEFAULT_TEXT;return d(a)?a(this.value):a}set errorMessage(a){this._text=a}init(){if(this.hasHTMLAttribute()){let a=this.getHTMLAttribute();a!==this.value&&(this.value=a)}else f(this.value)&&
this.setHTMLAttribute(this.value);return this}isEnabled(){return f(this.value)&&0<this.value}validate(a){this.isValid=this.isEnabled()?a.length<=this.value:!0;return{name:this.name,errorMessage:this.errorMessage,isValid:this.isValid}}setValue(a){this.value=a;this.setHTMLAttribute(this.value);return this}hasHTMLAttribute(){return p.hasHTMLAttribute(this.element)}getHTMLAttribute(){return p.getHTMLAttribute(this.element)}setHTMLAttribute(a){p.setHTMLAttribute(this.element,a)}static hasHTMLAttribute(a){return a.hasAttribute("maxlength")&&
""!==a.getAttribute("maxlength")}static getHTMLAttribute(a){return parseInt(a.getAttribute("maxlength"))}static setHTMLAttribute(a,b){a.setAttribute("maxlength",b)}static HTMLElementHasRule(a){return p.hasHTMLAttribute(a)}}class q{constructor(a={}){this.isValid=!0;this.value=a.value;a.errorMessage&&(this.errorMessage=a.errorMessage);a.element&&(this.element=a.element)}get name(){return q.ruleName}static get ruleName(){return"pattern"}static get DEFAULT_TEXT(){return B}set DEFAULT_TEXT(a){B=d(a)?a:
()=>a}get errorMessage(){let a=this._text||q.DEFAULT_TEXT;return d(a)?a(this.value):a}set errorMessage(a){this._text=a}init(){if(this.hasHTMLAttribute()){let c=this.getHTMLAttribute();var a;if(a=u(c)){a=c;var b=this.value;a=u(a)?u(b)?a.toString()===b.toString():!1:!1;a=!a}a&&(this.value=c)}else f(this.value)&&this.setHTMLAttribute(this.value);return this}isEnabled(){return f(this.value)}validate(a){this.isValid=this.isEnabled()&&a?this.value.test(a):!0;return{name:this.name,errorMessage:this.errorMessage,
isValid:this.isValid}}setValue(a){if(u(a))this.value=a;else if("string"===typeof a)this.value=new RegExp(a);else if("number"===typeof a)this.value=new RegExp(a.toString());else return console.error("pattern value must be RegExp, String or Number. Your value:",a),this;this.setHTMLAttribute(this.value);return this}hasHTMLAttribute(){return q.hasHTMLAttribute(this.element)}getHTMLAttribute(){return q.getHTMLAttribute(this.element)}setHTMLAttribute(a){q.setHTMLAttribute(this.element,a)}static hasHTMLAttribute(a){return a.hasAttribute("pattern")&&
""!==a.getAttribute("pattern")}static getHTMLAttribute(a){return a.getAttribute("pattern")}static setHTMLAttribute(a,b){a.setAttribute("pattern",b)}static HTMLElementHasRule(a){return q.hasHTMLAttribute(a)}}let V=[n,m,p,q,l];class F{constructor(a){this.toAdd=[];this.toRemove=[];this.element=a}createValidationClasses(a,b=""){let c=F.CLASS_PREFIX;""!=b&&(c=c+"-"+b.toLocaleLowerCase());a?(this.toAdd.push(`${c}-valid`),this.toRemove.push(`${c}-invalid`)):(this.toAdd.push(`${c}-invalid`),this.toRemove.push(`${c}-valid`));
return this}createValidatorRuleStateClasses(a){this.createValidationClasses(a.isValid,a.name);return this}createValidatorStateClasses(a,b){a.rules.forEach((a)=>this.createValidatorRuleStateClasses(a));this.createValidationClasses(a.isValid,b);return this}renderClasses(){this.element.classList.remove(...this.toRemove);this.element.classList.add(...this.toAdd);this.toRemove=[];this.toAdd=[];return this}}F.CLASS_PREFIX="paylane";class t{constructor(a,b,c){this.rules=[];this.isValid=!0;this.errorMessage=
"";this.toggleErrorOnValidate=!0;this.afterValidate=function(){};this.field=a;this.rules=b||[];c&&(this.errorMessageElement=c)}validate(a=this.toggleErrorOnValidate){let b=this.validateChildren(this.field.fields),c=this.validateSelf(this.field.getValue(),this.field);this.isValid=b.isValid&&c.isValid;this.errorMessage=c.errorMessage||"";(new F(this.field.element)).createValidatorStateClasses(b,"child").createValidatorStateClasses(c,"self").createValidationClasses(this.isValid).renderClasses();a&&(this.hideErrorMessage(),
c.isValid||this.showErrorMessage());this.afterValidate(this);return this}validateSelf(a,b){if(!this.rules.length)return{rules:[],errorMessage:"",isValid:!0};let c=this.rules.map((c)=>{c.validate(a,b);return c}),e=c.find((a)=>!a.isValid);return{rules:c,errorMessage:e?e.errorMessage:"",isValid:!e}}validateChildren(a=[]){if(!a.length)return{rules:[],errorMessage:"",isValid:!0};a=a.map((a)=>{a.validator.validate();return{name:a.getName(),errorMessage:a.validator.errorMessage,isValid:a.validator.isValid}});
let b=a.find((a)=>!a.isValid);return{rules:a,errorMessage:b?b.errorMessage:"",isValid:!b}}hideAllErrorMessages(){this.hideErrorMessage().hideChildrenErrorMessages();return this}hideChildrenErrorMessages(){if(!this.field.fields)return this;this.field.fields.forEach((a)=>{a.validator.hideErrorMessage()});return this}hideErrorMessage(){if(!this.errorMessageElement)return this;for(;this.errorMessageElement.firstChild;)this.errorMessageElement.removeChild(this.errorMessageElement.firstChild);return this}showErrorMessage(a=
this.errorMessage){let b=document.createElement("span");b.innerText=a;this.errorMessageElement.appendChild(b);return this}addRule(a){this.rules.push(a);return this}updateRule(a,b){let c=this.rules.findIndex((b)=>b.name===a);0>c&&this.addRule(b);this.rules[c]=b;return this}getRule(a){return this.rules.find((b)=>b.name===a)}}class X{constructor(a,b,c=null){this.element=a;(a=b.type)||(a=this.element,a="input"===a.nodeName.toLowerCase()?a.hasAttribute("type")&&""!==a.getAttribute("type")?a.getAttribute("type"):
"text":a.nodeName.toLowerCase());this.type=a;this.validator=new t(this,b.validator,b.errorMessageElement);b.name&&(this.name=b.name);this.parent=c;this.init()}get value(){return(this.element.value||"").trim()}set value(a){this.element.value=(a+"").trim()}getValue(){return this.value}clearValue(){this.value="";return this}getName(){return this.name||this.element.getAttribute("name")}init(){this.validator.validate(!1);H(this.element,"change keydown",()=>{this.validator.validate()},!1,250)}}class Y{constructor(a,
b,c=null){this.type="radio";this.element=a;this.inputs=a.querySelectorAll('input[type="radio"]');this.validator=new t(this,b.validator,b.errorMessageElement);b.name&&(this.name=b.name);this.parent=c;this.init()}get value(){let a=Array.from(this.inputs).find((a)=>!!a.checked);return a?a.value:""}set value(a){this.inputs.forEach(function(b){b.checked=b.value===a})}getValue(){return this.value}clearValue(){this.inputs.forEach(function(a){a.checked=!1});return this}getName(){return this.name||this.element.getAttribute("name")}init(){this.validator.validate(!1);
let a=()=>{this.validator.validate()};this.inputs.forEach(function(b){H(b,"change",a,!1,250)})}}class Z{constructor(a,b){this.type="fields-group";this.parent=null;this.fields=[];this.onSubmit=function(){};this.element=a;this.validator=new t(this,b.validator);this.validator=new t(this,b.validator,b.errorMessageElement);this.fields=b.fields;this.name=b.name}getName(){return this.name||this.element.getAttribute("id")}getField(a){return this.fields.find((b)=>b.getName()===a)}getValue(){let a={};this.fields.forEach((b)=>
{a[b.getName()]=b.getValue()});return a}clearValue(){this.fields.forEach((a)=>{a.clearValue()});return this}init(){return this}}class g{constructor(a={}){this.isValid=!0;this.value=!!a.value;a.errorMessage&&(this.errorMessage=a.errorMessage);a.element&&(this.element=a.element)}get name(){return g.ruleName}static get ruleName(){return"required"}static get DEFAULT_TEXT(){return r}static set DEFAULT_TEXT(a){r=d(a)?a:()=>a}get errorMessage(){let a=this._text||g.DEFAULT_TEXT;return d(a)?a(this.value):
a}set errorMessage(a){this._text=a}init(){this.hasHTMLAttribute()?(this.value=!0,this.setValue(!0)):this.value&&this.setHTMLAttribute(this.value);return this}isEnabled(){return!!this.value}validate(a){this.isValid=this.isEnabled()?!!a:!0;return{name:this.name,errorMessage:this.errorMessage,isValid:this.isValid}}setValue(a){this.value=!!a;this.setHTMLAttribute(this.value);return this}hasHTMLAttribute(){return g.hasHTMLAttribute(this.element)}getHTMLAttribute(){return g.getHTMLAttribute(this.element)}setHTMLAttribute(a){g.setHTMLAttribute(this.element,
a)}static hasHTMLAttribute(a){return!!Array.from(a.querySelectorAll('input[type="radio"]')).find((a)=>a.hasAttribute("required"))}static getHTMLAttribute(a){return g.hasHTMLAttribute(a)}static setHTMLAttribute(a,b){return a.querySelectorAll('input[type="radio"]').forEach((a)=>{b?a.setAttribute("required","required"):a.removeAttribute("required")})}static HTMLElementHasRule(a){return g.hasHTMLAttribute(a)}}class ea{constructor(a,b){this.type="form";this.parent=null;this.fields=[];this.onSubmit=function(){};
this.element=a;this.validator=new t(this,b.validator);this.fields=b.fields}getField(a){return this.fields.find((b)=>b.getName()===a)}getName(){return this.element.getAttribute("id")}getValue(){let a={};this.fields.forEach((b)=>{a[b.getName()]=b.getValue()});return a}clearValue(){this.fields.forEach((a)=>{a.clearValue()});return this}init(){this.element.setAttribute("novalidate","true");return this}setOnSubmit(a){this.onSubmit=a}}let h={card:"#payment .payment_method_paylane_credit_card",polishBankTransfer:"#payment .payment_method_paylane_polish_bank_transfer",
sepaDirectDebit:"#payment .payment_method_paylane_sepa_direct_debit"};r=()=>k.defaults.required;C=()=>k.defaults.cardNumber;D=()=>k.defaults.cardExpirationDate;E=()=>k.defaults.cardSecurityCode;B=()=>k.defaults.pattern;class fa{constructor(){this.generatingCardToken=this.hasCardToken=!1;this.tmpCardsData={number:"",expirationDate:"",securityCode:"",nameOnCard:""}}init(){let a=this,b=[];document.querySelector(h.card)&&(this.cardGroup=aa(),this.tokenInput=this.cardGroup.element.querySelector('input[name="payment_params_token"]'),
b.push(this.cardGroup));document.querySelector(h.sepaDirectDebit)&&(this.sepaDirectDebitGroup=ba(),b.push(this.sepaDirectDebitGroup));document.querySelector(h.polishBankTransfer)&&(this.polishBankTransferField=ca(),b.push(this.polishBankTransferField));0<b.length&&(this.checkoutForm=da(b),this.checkoutFormButton&&this.checkoutFormButton.removeEventListener("click",function(b){a.onClickButtonSubmit(b)}),this.checkoutFormButton=this.checkoutForm.element.querySelector("#place_order"),this.checkoutFormButton.addEventListener("click",
function(b){a.onClickButtonSubmit(b)}),this.togglePaymentMethods(w()),this.checkoutForm.init(),K().forEach(function(b){b.addEventListener("change",function(){a.togglePaymentMethods(this.value)})}))}onClickButtonSubmit(a){this.mustOverideSubmit(w())&&(this.checkoutForm.validator.hideAllErrorMessages(),this.checkoutForm.validator.validate(),this.checkoutForm.validator.isValid?"paylane_credit_card"===w()&&(this.generatingCardToken?a.preventDefault():this.hasCardToken?(this.cloneCard(),this.clearCard(),
this.toggleCardRequiredValidation(!1)):(a.preventDefault(),this.generatingCardToken=!0,this.generateToken((a)=>{this.tokenInput.value=a;this.hasCardToken=!0;this.generatingCardToken=!1;this.checkoutFormButton.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))},(a,c)=>{this.tokenInput.value="";this.generatingCardToken=this.hasCardToken=!1;this.cardGroup.validator.showErrorMessage(c)}))):a.preventDefault())}generateToken(a=()=>{},b=()=>{}){var c=T(this.cardGroup.getField("expirationDate").getValue());
c={cardNumber:v(this.cardGroup.getField("number").getValue()),expirationMonth:c.month,expirationYear:c.year,nameOnCard:this.cardGroup.getField("nameOnCard").getValue(),cardSecurityCode:this.cardGroup.getField("securityCode").getValue()};PayLane.card.generateToken(c,function(b){a(b)},function(a,c){b(a,c)})}togglePaymentMethods(a){document.querySelector(h.card)&&this.toggleCardGroup("paylane_credit_card"===a);document.querySelector(h.polishBankTransfer)&&this.togglePolishBankTransfer("paylane_polish_bank_transfer"===
a);document.querySelector(h.sepaDirectDebit)&&this.toggleSepaDDGroup("paylane_sepa_direct_debit"===a)}mustOverideSubmit(a){return"paylane_credit_card"===a||"paylane_polish_bank_transfer"===a||"paylane_sepa_direct_debit"===a}toggleCardGroup(a){this.toggleCardRequiredValidation(a);a?this.cardGroup.getField("nameOnCard").value=L():(this.clearCard(),this.tokenInput.value="",this.hasCardToken=!1);this.cardGroup.validator.hideAllErrorMessages()}cloneCard(){this.tmpCardsData.number=this.cardGroup.getField("number").value;
this.tmpCardsData.expirationDate=this.cardGroup.getField("expirationDate").value;this.tmpCardsData.securityCode=this.cardGroup.getField("securityCode").value;this.tmpCardsData.nameOnCard=this.cardGroup.getField("nameOnCard").value}restoreCard(){this.cardGroup.getField("number").value=this.tmpCardsData.number;this.cardGroup.getField("expirationDate").value=this.tmpCardsData.expirationDate;this.cardGroup.getField("securityCode").value=this.tmpCardsData.securityCode;this.cardGroup.getField("nameOnCard").value=
this.tmpCardsData.nameOnCard;this.removeCardFromCache();this.toggleCardRequiredValidation(!0)}removeCardFromCache(){this.tmpCardsData.number="";this.tmpCardsData.expirationDate="";this.tmpCardsData.securityCode="";this.tmpCardsData.nameOnCard=""}clearCard(){this.cardGroup.getField("number").clearValue();this.cardGroup.getField("expirationDate").clearValue();this.cardGroup.getField("securityCode").clearValue();this.cardGroup.getField("nameOnCard").clearValue()}toggleCardRequiredValidation(a){this.cardGroup.getField("number").validator.getRule("required").setValue(a);
this.cardGroup.getField("expirationDate").validator.getRule("required").setValue(a);this.cardGroup.getField("securityCode").validator.getRule("required").setValue(a);this.cardGroup.getField("nameOnCard").validator.getRule("required").setValue(a)}togglePolishBankTransfer(a){this.polishBankTransferField.validator.getRule("required").setValue(a);a||this.polishBankTransferField.clearValue();this.polishBankTransferField.validator.hideAllErrorMessages()}toggleSepaDDGroup(a){this.sepaDirectDebitGroup.getField("accountHolder").validator.getRule("required").setValue(a);
this.sepaDirectDebitGroup.getField("iban").validator.getRule("required").setValue(a);this.sepaDirectDebitGroup.getField("bic").validator.getRule("required").setValue(a);this.sepaDirectDebitGroup.getField("accountCountry").validator.getRule("required").setValue(a);if(a){if(this.sepaDirectDebitGroup.getField("accountHolder").value=L(),!this.sepaDirectDebitGroup.getField("accountCountry").element.hasAttribute("readonly")){a=this.sepaDirectDebitGroup.getField("accountCountry");var b=(b=document.querySelector('select[name="billing_country"]'))&&
b.value?b.value+"":"";a.value=b}}else this.sepaDirectDebitGroup.getField("accountHolder").clearValue(),this.sepaDirectDebitGroup.getField("iban").clearValue(),this.sepaDirectDebitGroup.getField("bic").clearValue(),this.sepaDirectDebitGroup.getField("accountCountry").element.hasAttribute("readonly")||this.sepaDirectDebitGroup.getField("accountCountry").clearValue();this.sepaDirectDebitGroup.validator.validate();this.sepaDirectDebitGroup.validator.hideAllErrorMessages()}}document.addEventListener("DOMContentLoaded",
function(){let a=new fa;a.init();jQuery(document.body).on("updated_checkout init_checkout",function(){a.init()});jQuery(document.body).on("checkout_error",function(){"paylane_credit_card"===w()&&a.restoreCard()})})})();
